name: CI - Tests & Coverage

on:
    push:
        branches:
            - main
    pull_requests:
        branches:
            - main

jobs:
    test-backend:
        name: Backend Tests
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            - name: Set up JDK 11
              uses: actions/setup-java@v4
              with:
                distribution: 'temurin'
                java-version: '11'

            - name: Run Backend Tests
              run: |
                cd back
                mvn test jacoco:report

            - name: Upload Backend Coverage Report
              uses: actions/upload-artifact@v4
              with:
                name: jacoco-report
                path: back/target/site/jacoco

    test-front-end:
        name: Frontend Tests
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            - name: Set up Node.js
              uses: actions/setup-node@v4
              with:
                node-version: 18

            - name: Install Dependencies
              run: |
                cd front
                npm install

            - name: Run Frontend Tests
              run: |
                cd front
                npm run test -- --code-coverage --watch=false

            - name: Upload Frontend Coverage Report
              uses: actions/upload-artifact@v4
              with:
                name: frontend-coverage-report
                path: front/coverage